---
import { Image } from "astro:assets";
import NavAuthButton from "./NavAuthButton";
import wishLogo from "../assets/WISHLOGO.svg";

const links = [
  { href: "/#about", label: "about" },
  { href: "/#benefits", label: "benefits" },
  { href: "/#schedule", label: "schedule" },
  { href: "/#sponsors", label: "sponsors" },
  { href: "/#faq", label: "FAQs" },
];
---

<header class="fixed inset-x-0 top-0 z-50 py-4">
  <div class="mx-auto w-full max-w-[1780px] px-4 sm:px-6 lg:px-8">
    <nav
      class="nav-mobile-bg relative flex items-center justify-between rounded-[24px] bg-black/80 px-6 py-3 shadow-[0px_0px_20px_0px_rgba(119,22,208,0.4)] backdrop-blur-md transition-all duration-300 sm:px-8 md:px-12 lg:rounded-[35px_4px_35px_4px] lg:bg-black/80"
    >
      <div class="flex shrink-0">
        <a href="/" class="group relative">
          <Image
            src={wishLogo}
            alt="WISH"
            class="h-6 w-auto drop-shadow-[0px_0px_8px_rgba(119,22,208,0.8)] transition-all duration-300 group-hover:drop-shadow-[0px_0px_12px_rgba(183,67,255,1)] sm:h-7 lg:h-9 xl:h-10"
          />
        </a>
      </div>

      <div class="hidden items-center gap-6 lg:flex xl:gap-12" id="nav-links">
        {
          links.map((link) => (
            <a
              href={link.href}
              class="font-['Marcellus'] text-base text-white/90 transition-colors duration-200 hover:text-[#B743FF] xl:text-lg"
            >
              {link.label}
            </a>
          ))
        }

        <NavAuthButton client:load />
      </div>

      <button
        id="mobile-menu-btn"
        class="p-1 lg:hidden"
        aria-label="Toggle menu"
        aria-expanded="false"
        aria-controls="mobile-menu"
      >
        <svg
          class="h-8 w-8 text-white"
          fill="none"
          stroke-linecap="round"
          stroke-linejoin="round"
          stroke-width="2"
          viewBox="0 0 24 24"
          stroke="currentColor"
        >
          <path id="hamburger-icon" d="M4 6h16M4 12h16M4 18h16"></path>
          <path id="close-icon" class="hidden" d="M6 18L18 6M6 6l12 12"></path>
        </svg>
      </button>
    </nav>

    <div
      id="mobile-menu"
      class="mobile-menu-closed overflow-hidden transition-[max-height] duration-500 ease-in-out lg:hidden"
      aria-hidden="true"
    >
      <div class="flex flex-col items-center" id="mobile-nav-links">
        {
          links.map((link, i) => (
            <div
              class="mobile-nav-item flex justify-center"
              style={`width: ${95 - i * 9}%`}
            >
              <a
                href={link.href}
                class="block w-full py-3 text-center font-['Marcellus'] text-xl font-normal text-white transition-colors duration-200 hover:text-[#E0AAFF]"
              >
                {link.label}
              </a>
            </div>
          ))
        }

        <div class="flex justify-center py-3" style="width: auto">
          <NavAuthButton mobile client:load />
        </div>
      </div>
    </div>
  </div>

  <script>
    import { setupMobileMenu } from "../utils/mobileMenu.ts";
    import { setupSmoothScroll } from "../utils/smoothScroll.ts";

    setupSmoothScroll("#nav-links");
    setupSmoothScroll("#mobile-nav-links");

    setupMobileMenu({
      btnId: "mobile-menu-btn",
      menuId: "mobile-menu",
      hamburgerId: "hamburger-icon",
      closeId: "close-icon",
      linksSelector: "#mobile-nav-links a",
    });
  </script>
</header>

<style>
  .mobile-menu-closed {
    max-height: 0;
    pointer-events: none;
    visibility: hidden;
  }

  .mobile-menu-open {
    max-height: 700px;
    pointer-events: auto;
    visibility: visible;
  }

  .mobile-nav-item {
    background: linear-gradient(
      90deg,
      rgba(0, 0, 0, 1) 0%,
      rgba(65, 8, 115, 0.95) 49%,
      rgba(0, 0, 0, 1) 93%
    );
    border-radius: 0 0 2rem 2rem;
    margin-bottom: 1px;
    box-shadow:
      0px 6px 20px 0px rgba(119, 22, 208, 0.5),
      0px 0px 8px 0px rgba(119, 22, 208, 0.25);
  }

  @media (max-width: 1023px) {
    .nav-mobile-bg {
      background: linear-gradient(
        90deg,
        rgba(0, 0, 0, 0.95) 0%,
        rgba(60, 10, 110, 0.92) 49%,
        rgba(0, 0, 0, 0.95) 93%
      ) !important;
      box-shadow:
        0px 0px 0px 1px rgba(119, 22, 208, 0.4),
        0px 0px 18px 2px rgba(119, 22, 208, 0.45),
        0px 0px 40px 4px rgba(119, 22, 208, 0.2) !important;
    }
  }
</style>
